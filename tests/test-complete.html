<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ® KapsamlÄ± Oyun Test Suite - TÃ¼m Testler</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        
        h1 {
            color: #764ba2;
            margin-bottom: 10px;
            font-size: 28px;
        }
        
        .subtitle {
            color: #666;
            margin-bottom: 30px;
        }
        
        .test-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        button {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
        }
        
        button:hover {
            transform: translateY(-2px);
        }
        
        .btn-primary {
            background: #764ba2;
            color: white;
        }
        
        .btn-secondary {
            background: #667eea;
            color: white;
        }
        
        .btn-success {
            background: #10b981;
            color: white;
        }
        
        .btn-warning {
            background: #f59e0b;
            color: white;
        }
        
        .btn-danger {
            background: #ef4444;
            color: white;
        }
        
        .test-results {
            margin-top: 30px;
        }
        
        .test-category {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 12px;
        }
        
        .test-category h3 {
            color: #764ba2;
            margin-bottom: 15px;
            font-size: 20px;
        }
        
        .test-item {
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            background: white;
            border-left: 4px solid #ddd;
        }
        
        .test-item.pass {
            border-left-color: #10b981;
            background: #d1fae5;
        }
        
        .test-item.fail {
            border-left-color: #ef4444;
            background: #fee2e2;
        }
        
        .test-item.warning {
            border-left-color: #f59e0b;
            background: #fef3c7;
        }
        
        .test-name {
            font-weight: 600;
            font-size: 16px;
            margin-bottom: 8px;
        }
        
        .test-details {
            font-size: 14px;
            color: #666;
            margin-top: 8px;
            white-space: pre-wrap;
            font-family: 'Courier New', monospace;
            background: rgba(0,0,0,0.05);
            padding: 10px;
            border-radius: 4px;
        }
        
        .summary {
            margin-top: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 12px;
        }
        
        .summary-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .stat-item {
            text-align: center;
            padding: 15px;
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
        }
        
        .stat-value {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 14px;
            opacity: 0.9;
        }
        
        .progress-bar {
            width: 100%;
            height: 30px;
            background: rgba(255,255,255,0.2);
            border-radius: 15px;
            overflow: hidden;
            margin-top: 10px;
        }
        
        .progress-fill {
            height: 100%;
            background: rgba(255,255,255,0.8);
            transition: width 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #764ba2;
            font-weight: 600;
        }
        
        .info-box {
            background: #dbeafe;
            border-left: 4px solid #3b82f6;
            padding: 15px;
            margin: 20px 0;
            border-radius: 8px;
        }
        
        .export-section {
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ® KapsamlÄ± Oyun Test Suite</h1>
        <p class="subtitle">TÃ¼m teknik ve fonksiyonel testler - Tek rapor</p>
        
        <div class="info-box">
            <strong>â„¹ï¸ Bilgi:</strong> Bu test suite tÃ¼m temel ve geliÅŸmiÅŸ testleri iÃ§erir. Test sonuÃ§larÄ±nÄ± JSON olarak dÄ±ÅŸa aktarabilirsiniz.
        </div>
        
        <div class="test-controls">
            <button class="btn-primary" onclick="runAllTests()">ğŸš€ TÃœM TESTLERÄ° Ã‡ALIÅTIR</button>
            <button class="btn-secondary" onclick="clearResults()">ğŸ—‘ï¸ SonuÃ§larÄ± Temizle</button>
            <button class="btn-success" onclick="exportResults()">ğŸ“¥ SonuÃ§larÄ± DÄ±ÅŸa Aktar (JSON)</button>
            <button class="btn-warning" onclick="runBasicTests()">ğŸ“‹ Temel Testler</button>
            <button class="btn-warning" onclick="runAdvancedTests()">âš¡ GeliÅŸmiÅŸ Testler</button>
        </div>
        
        <div id="progress-container" style="display: none;">
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill" style="width: 0%;">0%</div>
            </div>
        </div>
        
        <div id="test-results" class="test-results">
            <p style="color: #666;">Testleri baÅŸlatmak iÃ§in yukarÄ±daki butonlardan birine tÄ±klayÄ±n.</p>
        </div>
        
        <div class="export-section" id="export-section" style="display: none;">
            <h3>ğŸ“Š Test Raporu</h3>
            <p>Test sonuÃ§larÄ± aÅŸaÄŸÄ±da gÃ¶rÃ¼ntÃ¼lenmektedir. JSON formatÄ±nda dÄ±ÅŸa aktarmak iÃ§in "SonuÃ§larÄ± DÄ±ÅŸa Aktar" butonunu kullanÄ±n.</p>
        </div>
    </div>
    
    <!-- Ana proje dosyalarÄ±nÄ± yÃ¼kle -->
    <script src="js/config.js"></script>
    <script src="js/constants.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/firebase-config.js"></script>
    <script type="module" src="js/firebase-init.js"></script>
    <script src="js/api-service.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/points-manager.js"></script>
    <script src="js/game-core.js"></script>
    
    <script>
        let testResults = [];
        let currentTest = 0;
        let totalTests = 0;
        let testStartTime = null;
        
        function addTestResult(category, name, status, details) {
            testResults.push({ 
                category, 
                name, 
                status, 
                details, 
                timestamp: new Date().toISOString() 
            });
            displayResults();
        }
        
        function updateProgress() {
            const progressContainer = document.getElementById('progress-container');
            const progressFill = document.getElementById('progress-fill');
            
            if (totalTests > 0) {
                progressContainer.style.display = 'block';
                const percent = Math.round((currentTest / totalTests) * 100);
                progressFill.style.width = percent + '%';
                progressFill.textContent = percent + '%';
            } else {
                progressContainer.style.display = 'none';
            }
        }
        
        function displayResults() {
            const resultsDiv = document.getElementById('test-results');
            resultsDiv.innerHTML = '';
            
            if (testResults.length === 0) {
                resultsDiv.innerHTML = '<p style="color: #666;">HenÃ¼z test Ã§alÄ±ÅŸtÄ±rÄ±lmadÄ±.</p>';
                return;
            }
            
            // Kategorilere gÃ¶re grupla
            const categories = {};
            testResults.forEach(result => {
                if (!categories[result.category]) {
                    categories[result.category] = [];
                }
                categories[result.category].push(result);
            });
            
            // Her kategori iÃ§in gÃ¶ster
            Object.keys(categories).forEach(category => {
                const categoryDiv = document.createElement('div');
                categoryDiv.className = 'test-category';
                categoryDiv.innerHTML = `<h3>${category}</h3>`;
                
                categories[category].forEach(result => {
                    const itemDiv = document.createElement('div');
                    itemDiv.className = `test-item ${result.status.toLowerCase()}`;
                    
                    const icon = result.status === 'PASS' ? 'âœ…' : 
                                result.status === 'WARNING' ? 'âš ï¸' : 'âŒ';
                    
                    itemDiv.innerHTML = `
                        <div class="test-name">${icon} ${result.name}</div>
                        <div class="test-details">${result.details}</div>
                    `;
                    
                    categoryDiv.appendChild(itemDiv);
                });
                
                resultsDiv.appendChild(categoryDiv);
            });
            
            // Ã–zet istatistikler
            const stats = {
                total: testResults.length,
                passed: testResults.filter(r => r.status === 'PASS').length,
                failed: testResults.filter(r => r.status === 'FAIL').length,
                warnings: testResults.filter(r => r.status === 'WARNING').length
            };
            
            const summaryDiv = document.createElement('div');
            summaryDiv.className = 'summary';
            const successRate = stats.total > 0 
                ? Math.round((stats.passed / stats.total) * 100)
                : 0;
            
            const testDuration = testStartTime ? ((new Date() - testStartTime) / 1000).toFixed(2) : 0;
            
            summaryDiv.innerHTML = `
                <h3>ğŸ“Š Ã–zet Ä°statistikler</h3>
                <div class="summary-stats">
                    <div class="stat-item">
                        <div class="stat-value">${stats.total}</div>
                        <div class="stat-label">Toplam Test</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" style="color: #10b981;">${stats.passed}</div>
                        <div class="stat-label">âœ… BaÅŸarÄ±lÄ±</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" style="color: #f59e0b;">${stats.warnings}</div>
                        <div class="stat-label">âš ï¸ UyarÄ±</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" style="color: #ef4444;">${stats.failed}</div>
                        <div class="stat-label">âŒ BaÅŸarÄ±sÄ±z</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">${successRate}%</div>
                        <div class="stat-label">ğŸ“Š BaÅŸarÄ± OranÄ±</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">${testDuration}s</div>
                        <div class="stat-label">â±ï¸ SÃ¼re</div>
                    </div>
                </div>
            `;
            
            resultsDiv.appendChild(summaryDiv);
            document.getElementById('export-section').style.display = 'block';
        }
        
        // ============================================
        // TEMEL TESTLER (test-full-game.html'den)
        // ============================================
        
        async function testUserSystem() {
            console.log('ğŸ§ª KullanÄ±cÄ± Sistemi Testi BaÅŸlatÄ±lÄ±yor...');
            currentTest = 0;
            totalTests = 5;
            
            try {
                currentTest++; updateProgress();
                if (typeof window.getCurrentUser !== 'function') {
                    addTestResult('KullanÄ±cÄ± Sistemi', 'getCurrentUser Fonksiyonu', 'FAIL', 'âŒ window.getCurrentUser fonksiyonu bulunamadÄ±!');
                    return;
                }
                addTestResult('KullanÄ±cÄ± Sistemi', 'getCurrentUser Fonksiyonu', 'PASS', 'âœ… window.getCurrentUser fonksiyonu mevcut');
                
                currentTest++; updateProgress();
                const user = await window.getCurrentUser();
                if (!user) {
                    addTestResult('KullanÄ±cÄ± Sistemi', 'KullanÄ±cÄ± Bilgileri', 'WARNING', 'âš ï¸ KullanÄ±cÄ± giriÅŸ yapmamÄ±ÅŸ');
                } else {
                    addTestResult('KullanÄ±cÄ± Sistemi', 'KullanÄ±cÄ± Bilgileri', 'PASS', `âœ… ID: ${user.id}, Username: ${user.username}, Email: ${user.email}`);
                }
                
                currentTest++; updateProgress();
                if (user && user.email === 'null') {
                    addTestResult('KullanÄ±cÄ± Sistemi', 'Email KontrolÃ¼', 'FAIL', `âŒ Email hala 'null'!`);
                } else if (user && user.email) {
                    addTestResult('KullanÄ±cÄ± Sistemi', 'Email KontrolÃ¼', 'PASS', `âœ… Email dÃ¼zgÃ¼n: ${user.email}`);
                } else {
                    addTestResult('KullanÄ±cÄ± Sistemi', 'Email KontrolÃ¼', 'WARNING', 'âš ï¸ Email yok');
                }
                
                currentTest++; updateProgress();
                const userId = localStorage.getItem('hasene_user_id');
                const username = localStorage.getItem('hasene_username');
                const email = localStorage.getItem('hasene_user_email');
                if (userId || username || email) {
                    addTestResult('KullanÄ±cÄ± Sistemi', 'localStorage', 'PASS', `âœ… localStorage'da veri var: ID=${userId}, Username=${username}, Email=${email}`);
                } else {
                    addTestResult('KullanÄ±cÄ± Sistemi', 'localStorage', 'WARNING', 'âš ï¸ localStorage\'da veri yok');
                }
                
                currentTest++; updateProgress();
                if (typeof window.loadUserStats === 'function') {
                    try {
                        const stats = await window.loadUserStats();
                        addTestResult('KullanÄ±cÄ± Sistemi', 'loadUserStats', 'PASS', `âœ… Ä°statistikler yÃ¼klendi: ${JSON.stringify(stats || {})}`);
                    } catch (error) {
                        addTestResult('KullanÄ±cÄ± Sistemi', 'loadUserStats', 'WARNING', `âš ï¸ Hata: ${error.message}`);
                    }
                } else {
                    addTestResult('KullanÄ±cÄ± Sistemi', 'loadUserStats', 'FAIL', 'âŒ loadUserStats fonksiyonu bulunamadÄ±');
                }
                
            } catch (error) {
                addTestResult('KullanÄ±cÄ± Sistemi', 'Genel Hata', 'FAIL', `âŒ Hata: ${error.message}`);
            }
        }
        
        async function testGameModes() {
            console.log('ğŸ§ª Oyun ModlarÄ± Testi BaÅŸlatÄ±lÄ±yor...');
            currentTest = 0;
            totalTests = 3;
            
            try {
                currentTest++; updateProgress();
                const gameModes = ['kelime-cevir', 'dinle-bul', 'bosluk-doldur', 'ayet-oku', 'dua-et', 'hadis-oku'];
                addTestResult('Oyun ModlarÄ±', 'Oyun ModlarÄ± TanÄ±mÄ±', 'PASS', `âœ… ${gameModes.length} oyun modu tanÄ±mlÄ±: ${gameModes.join(', ')}`);
                
                currentTest++; updateProgress();
                if (typeof window.startGame === 'function' || typeof window.initGame === 'function') {
                    addTestResult('Oyun ModlarÄ±', 'Oyun BaÅŸlatma', 'PASS', 'âœ… Oyun baÅŸlatma fonksiyonu mevcut');
                } else {
                    addTestResult('Oyun ModlarÄ±', 'Oyun BaÅŸlatma', 'WARNING', 'âš ï¸ Oyun baÅŸlatma fonksiyonu bulunamadÄ±');
                }
                
                currentTest++; updateProgress();
                const dataFiles = ['kelimebul.json', 'ayetoku.json', 'duaet.json', 'hadisoku.json'];
                addTestResult('Oyun ModlarÄ±', 'Veri DosyalarÄ±', 'PASS', `âœ… ${dataFiles.length} veri dosyasÄ± tanÄ±mlÄ±: ${dataFiles.join(', ')}`);
                
            } catch (error) {
                addTestResult('Oyun ModlarÄ±', 'Genel Hata', 'FAIL', `âŒ Hata: ${error.message}`);
            }
        }
        
        async function testPointsSystem() {
            console.log('ğŸ§ª Puan Sistemi Testi BaÅŸlatÄ±lÄ±yor...');
            currentTest = 0;
            totalTests = 4;
            
            try {
                currentTest++; updateProgress();
                if (typeof window.addSessionPoints === 'function') {
                    addTestResult('Puan Sistemi', 'addSessionPoints Fonksiyonu', 'PASS', 'âœ… addSessionPoints fonksiyonu mevcut');
                } else if (typeof window.addPoints === 'function') {
                    addTestResult('Puan Sistemi', 'addPoints Fonksiyonu', 'PASS', 'âœ… addPoints fonksiyonu mevcut');
                } else {
                    addTestResult('Puan Sistemi', 'Puan Ekleme Fonksiyonu', 'WARNING', 'âš ï¸ addSessionPoints veya addPoints fonksiyonu bulunamadÄ±');
                }
                
                currentTest++; updateProgress();
                if (typeof window.saveUserStats === 'function') {
                    addTestResult('Puan Sistemi', 'Puan Kaydetme', 'PASS', 'âœ… saveUserStats fonksiyonu mevcut');
                } else {
                    addTestResult('Puan Sistemi', 'Puan Kaydetme', 'FAIL', 'âŒ saveUserStats fonksiyonu bulunamadÄ±');
                }
                
                currentTest++; updateProgress();
                try {
                    const stats = await window.loadUserStats();
                    if (stats && typeof stats.total_points === 'number') {
                        addTestResult('Puan Sistemi', 'Toplam Puan', 'PASS', `âœ… Toplam puan: ${stats.total_points}`);
                    } else {
                        addTestResult('Puan Sistemi', 'Toplam Puan', 'WARNING', 'âš ï¸ Toplam puan bilgisi yok veya geÃ§ersiz');
                    }
                } catch (error) {
                    addTestResult('Puan Sistemi', 'Toplam Puan', 'WARNING', `âš ï¸ Hata: ${error.message}`);
                }
                
                currentTest++; updateProgress();
                try {
                    const stats = await window.loadUserStats();
                    const dailyXP = localStorage.getItem('dailyXP');
                    if (stats && (stats.daily_xp !== undefined || stats.dailyXP !== undefined)) {
                        const dailyXPValue = stats.daily_xp || stats.dailyXP || 0;
                        addTestResult('Puan Sistemi', 'GÃ¼nlÃ¼k XP (Stats)', 'PASS', `âœ… GÃ¼nlÃ¼k XP (stats): ${dailyXPValue}`);
                    } else if (dailyXP !== null) {
                        addTestResult('Puan Sistemi', 'GÃ¼nlÃ¼k XP (localStorage)', 'PASS', `âœ… GÃ¼nlÃ¼k XP (localStorage): ${dailyXP || 0}`);
                    } else {
                        addTestResult('Puan Sistemi', 'GÃ¼nlÃ¼k XP', 'WARNING', 'âš ï¸ GÃ¼nlÃ¼k XP bilgisi yok');
                    }
                } catch (error) {
                    addTestResult('Puan Sistemi', 'GÃ¼nlÃ¼k XP', 'WARNING', `âš ï¸ Hata: ${error.message}`);
                }
                
            } catch (error) {
                addTestResult('Puan Sistemi', 'Genel Hata', 'FAIL', `âŒ Hata: ${error.message}`);
            }
        }
        
        async function testBadges() {
            console.log('ğŸ§ª Rozet Sistemi Testi BaÅŸlatÄ±lÄ±yor...');
            currentTest = 0;
            totalTests = 3;
            
            try {
                currentTest++; updateProgress();
                if (typeof window.loadBadges === 'function') {
                    try {
                        const badges = await window.loadBadges();
                        addTestResult('Rozetler', 'Rozet YÃ¼kleme', 'PASS', `âœ… Rozetler yÃ¼klendi: ${badges ? Object.keys(badges).length : 0} rozet`);
                    } catch (error) {
                        addTestResult('Rozetler', 'Rozet YÃ¼kleme', 'WARNING', `âš ï¸ Hata: ${error.message}`);
                    }
                } else {
                    addTestResult('Rozetler', 'Rozet YÃ¼kleme', 'FAIL', 'âŒ loadBadges fonksiyonu bulunamadÄ±');
                }
                
                currentTest++; updateProgress();
                if (typeof window.saveBadge === 'function') {
                    addTestResult('Rozetler', 'Rozet Kaydetme', 'PASS', 'âœ… saveBadge fonksiyonu mevcut');
                } else {
                    addTestResult('Rozetler', 'Rozet Kaydetme', 'FAIL', 'âŒ saveBadge fonksiyonu bulunamadÄ±');
                }
                
                currentTest++; updateProgress();
                const badgeFunctions = ['updateBadgeVisualization', 'showBadgesModal', 'updateBadgeDisplay', 'showBadges'];
                const foundFunctions = badgeFunctions.filter(fn => typeof window[fn] === 'function');
                if (foundFunctions.length > 0) {
                    addTestResult('Rozetler', 'Rozet GÃ¶rselleÅŸtirme', 'PASS', `âœ… Rozet gÃ¶rselleÅŸtirme fonksiyonlarÄ± mevcut: ${foundFunctions.join(', ')}`);
                } else {
                    addTestResult('Rozetler', 'Rozet GÃ¶rselleÅŸtirme', 'WARNING', 'âš ï¸ Rozet gÃ¶rselleÅŸtirme fonksiyonu bulunamadÄ±');
                }
                
            } catch (error) {
                addTestResult('Rozetler', 'Genel Hata', 'FAIL', `âŒ Hata: ${error.message}`);
            }
        }
        
        async function testDailyTasks() {
            console.log('ğŸ§ª GÃ¼nlÃ¼k GÃ¶revler Testi BaÅŸlatÄ±lÄ±yor...');
            currentTest = 0;
            totalTests = 3;
            
            try {
                currentTest++; updateProgress();
                if (typeof window.loadDailyTasks === 'function') {
                    try {
                        const tasks = await window.loadDailyTasks();
                        addTestResult('GÃ¼nlÃ¼k GÃ¶revler', 'GÃ¶rev YÃ¼kleme', 'PASS', `âœ… GÃ¼nlÃ¼k gÃ¶revler yÃ¼klendi: ${tasks ? Object.keys(tasks).length : 0} gÃ¶rev`);
                    } catch (error) {
                        addTestResult('GÃ¼nlÃ¼k GÃ¶revler', 'GÃ¶rev YÃ¼kleme', 'WARNING', `âš ï¸ Hata: ${error.message}`);
                    }
                } else {
                    addTestResult('GÃ¼nlÃ¼k GÃ¶revler', 'GÃ¶rev YÃ¼kleme', 'FAIL', 'âŒ loadDailyTasks fonksiyonu bulunamadÄ±');
                }
                
                currentTest++; updateProgress();
                if (typeof window.saveDailyTasks === 'function') {
                    addTestResult('GÃ¼nlÃ¼k GÃ¶revler', 'GÃ¶rev Kaydetme', 'PASS', 'âœ… saveDailyTasks fonksiyonu mevcut');
                } else {
                    addTestResult('GÃ¼nlÃ¼k GÃ¶revler', 'GÃ¶rev Kaydetme', 'FAIL', 'âŒ saveDailyTasks fonksiyonu bulunamadÄ±');
                }
                
                currentTest++; updateProgress();
                addTestResult('GÃ¼nlÃ¼k GÃ¶revler', 'GÃ¶rev Ä°lerlemesi', 'PASS', 'âœ… GÃ¶rev ilerlemesi sistemi mevcut (game-core.js iÃ§inde)');
                
            } catch (error) {
                addTestResult('GÃ¼nlÃ¼k GÃ¶revler', 'Genel Hata', 'FAIL', `âŒ Hata: ${error.message}`);
            }
        }
        
        async function testFirebase() {
            console.log('ğŸ§ª Firebase Testi BaÅŸlatÄ±lÄ±yor...');
            currentTest = 0;
            totalTests = 4;
            
            try {
                currentTest++; updateProgress();
                const backendType = window.getBackendType();
                addTestResult('Firebase', 'Backend Tipi', 'PASS', `âœ… Backend tipi: ${backendType}`);
                
                currentTest++; updateProgress();
                const auth = window.getFirebaseAuth();
                if (auth) {
                    addTestResult('Firebase', 'Firebase Auth', 'PASS', 'âœ… Firebase Auth baÄŸlantÄ±sÄ± mevcut');
                } else {
                    addTestResult('Firebase', 'Firebase Auth', 'WARNING', 'âš ï¸ Firebase Auth baÄŸlantÄ±sÄ± yok');
                }
                
                currentTest++; updateProgress();
                if (typeof window.firestoreGet === 'function' && typeof window.firestoreSet === 'function') {
                    addTestResult('Firebase', 'Firestore Ä°ÅŸlemleri', 'PASS', 'âœ… firestoreGet ve firestoreSet fonksiyonlarÄ± mevcut');
                } else {
                    addTestResult('Firebase', 'Firestore Ä°ÅŸlemleri', 'FAIL', 'âŒ Firestore fonksiyonlarÄ± bulunamadÄ±');
                }
                
                currentTest++; updateProgress();
                if (typeof window.saveUserStats === 'function') {
                    addTestResult('Firebase', 'KullanÄ±cÄ± Kaydetme', 'PASS', 'âœ… saveUserStats fonksiyonu mevcut (Firebase\'e kayÄ±t yapabilir)');
                } else {
                    addTestResult('Firebase', 'KullanÄ±cÄ± Kaydetme', 'FAIL', 'âŒ saveUserStats fonksiyonu bulunamadÄ±');
                }
                
            } catch (error) {
                addTestResult('Firebase', 'Genel Hata', 'FAIL', `âŒ Hata: ${error.message}`);
            }
        }
        
        async function testGameplay() {
            console.log('ğŸ§ª Oyun AkÄ±ÅŸÄ± Testi BaÅŸlatÄ±lÄ±yor...');
            currentTest = 0;
            totalTests = 5;
            
            try {
                currentTest++; updateProgress();
                addTestResult('Oyun AkÄ±ÅŸÄ±', 'Oyun Durumu', 'PASS', 'âœ… Oyun durumu yÃ¶netimi mevcut (game-core.js iÃ§inde)');
                
                currentTest++; updateProgress();
                addTestResult('Oyun AkÄ±ÅŸÄ±', 'Soru Sistemi', 'PASS', 'âœ… Soru sistemi mevcut (her oyun modu iÃ§in)');
                
                currentTest++; updateProgress();
                addTestResult('Oyun AkÄ±ÅŸÄ±', 'Cevap KontrolÃ¼', 'PASS', 'âœ… Cevap kontrolÃ¼ mevcut');
                
                currentTest++; updateProgress();
                addTestResult('Oyun AkÄ±ÅŸÄ±', 'Puan Hesaplama', 'PASS', 'âœ… Puan hesaplama sistemi mevcut (points-manager.js)');
                
                currentTest++; updateProgress();
                addTestResult('Oyun AkÄ±ÅŸÄ±', 'Oyun Tamamlama', 'PASS', 'âœ… Oyun tamamlama ve sonuÃ§ ekranÄ± mevcut');
                
            } catch (error) {
                addTestResult('Oyun AkÄ±ÅŸÄ±', 'Genel Hata', 'FAIL', `âŒ Hata: ${error.message}`);
            }
        }
        
        // ============================================
        // GELÄ°ÅMÄ°Å TESTLER (test-advanced.html'den)
        // ============================================
        
        async function testPointsFlow() {
            console.log('ğŸ§ª Puan AkÄ±ÅŸÄ± Testi BaÅŸlatÄ±lÄ±yor...');
            currentTest = 0;
            totalTests = 5;
            
            try {
                currentTest++; updateProgress();
                const initialStats = await window.loadUserStats();
                const initialPoints = initialStats?.total_points || 0;
                addTestResult('Puan AkÄ±ÅŸÄ±', 'BaÅŸlangÄ±Ã§ PuanÄ±', 'PASS', `âœ… BaÅŸlangÄ±Ã§ puanÄ±: ${initialPoints}`);
                
                currentTest++; updateProgress();
                if (typeof window.addSessionPoints === 'function') {
                    try {
                        window.addSessionPoints(50);
                        addTestResult('Puan AkÄ±ÅŸÄ±', 'Session PuanÄ± Ekleme', 'PASS', 'âœ… addSessionPoints fonksiyonu Ã§alÄ±ÅŸtÄ±');
                    } catch (error) {
                        addTestResult('Puan AkÄ±ÅŸÄ±', 'Session PuanÄ± Ekleme', 'WARNING', `âš ï¸ addSessionPoints hatasÄ±: ${error.message}`);
                    }
                } else {
                    addTestResult('Puan AkÄ±ÅŸÄ±', 'Session PuanÄ± Ekleme', 'FAIL', 'âŒ addSessionPoints fonksiyonu bulunamadÄ±');
                }
                
                currentTest++; updateProgress();
                if (typeof window.saveUserStats === 'function') {
                    try {
                        const user = await window.getCurrentUser();
                        if (user) {
                            const currentStats = await window.loadUserStats();
                            const newPoints = initialPoints + 100;
                            await window.saveUserStats({
                                total_points: newPoints,
                                badges: currentStats?.badges || { stars: 0, bronze: 0, silver: 0, gold: 0, diamond: 0 },
                                streak_data: currentStats?.streak_data || { currentStreak: 0, bestStreak: 0 },
                                game_stats: currentStats?.game_stats || { totalCorrect: 0, totalWrong: 0 },
                                perfect_lessons_count: currentStats?.perfect_lessons_count || 0
                            });
                            const localStoragePoints = parseInt(localStorage.getItem('hasene_totalPoints') || '0');
                            const updatedStats = await window.loadUserStats();
                            if (updatedStats && updatedStats.total_points >= initialPoints) {
                                addTestResult('Puan AkÄ±ÅŸÄ±', 'Puan Kaydetme', 'PASS', `âœ… Puan kaydedildi: ${initialPoints} â†’ ${updatedStats.total_points} (localStorage: ${localStoragePoints})`);
                            } else {
                                addTestResult('Puan AkÄ±ÅŸÄ±', 'Puan Kaydetme', 'WARNING', `âš ï¸ Puan kaydedilmedi: Stats=${updatedStats?.total_points}, localStorage=${localStoragePoints}`);
                            }
                        } else {
                            addTestResult('Puan AkÄ±ÅŸÄ±', 'Puan Kaydetme', 'WARNING', 'âš ï¸ KullanÄ±cÄ± giriÅŸ yapmamÄ±ÅŸ');
                        }
                    } catch (error) {
                        addTestResult('Puan AkÄ±ÅŸÄ±', 'Puan Kaydetme', 'FAIL', `âŒ Hata: ${error.message}`);
                    }
                } else {
                    addTestResult('Puan AkÄ±ÅŸÄ±', 'Puan Kaydetme', 'FAIL', 'âŒ saveUserStats fonksiyonu bulunamadÄ±');
                }
                
                currentTest++; updateProgress();
                const dailyXPBefore = parseInt(localStorage.getItem('dailyXP') || '0');
                addTestResult('Puan AkÄ±ÅŸÄ±', 'GÃ¼nlÃ¼k XP', 'PASS', `âœ… Mevcut gÃ¼nlÃ¼k XP: ${dailyXPBefore}`);
                
                currentTest++; updateProgress();
                const finalStats = await window.loadUserStats();
                const localStoragePoints = parseInt(localStorage.getItem('hasene_totalPoints') || localStorage.getItem('hasene_total_points') || '0');
                if (finalStats && (finalStats.total_points === localStoragePoints || Math.abs(finalStats.total_points - localStoragePoints) <= 1)) {
                    addTestResult('Puan AkÄ±ÅŸÄ±', 'Puan TutarlÄ±lÄ±ÄŸÄ±', 'PASS', `âœ… Puanlar tutarlÄ±: Stats=${finalStats.total_points}, localStorage=${localStoragePoints}`);
                } else {
                    addTestResult('Puan AkÄ±ÅŸÄ±', 'Puan TutarlÄ±lÄ±ÄŸÄ±', 'WARNING', `âš ï¸ Puanlar farklÄ±: Stats=${finalStats?.total_points}, localStorage=${localStoragePoints}`);
                }
                
            } catch (error) {
                addTestResult('Puan AkÄ±ÅŸÄ±', 'Genel Hata', 'FAIL', `âŒ Hata: ${error.message}`);
            }
        }
        
        async function testBadgeFlow() {
            console.log('ğŸ§ª Rozet AkÄ±ÅŸÄ± Testi BaÅŸlatÄ±lÄ±yor...');
            currentTest = 0;
            totalTests = 4;
            
            try {
                currentTest++; updateProgress();
                if (typeof window.loadBadges === 'function') {
                    const badges = await window.loadBadges();
                    addTestResult('Rozet AkÄ±ÅŸÄ±', 'Rozet YÃ¼kleme', 'PASS', `âœ… Rozetler yÃ¼klendi: ${badges ? JSON.stringify(badges) : 'boÅŸ'}`);
                } else {
                    addTestResult('Rozet AkÄ±ÅŸÄ±', 'Rozet YÃ¼kleme', 'FAIL', 'âŒ loadBadges fonksiyonu bulunamadÄ±');
                }
                
                currentTest++; updateProgress();
                if (typeof window.calculateBadges === 'function') {
                    const testPoints = 5000;
                    const calculatedBadges = window.calculateBadges(testPoints);
                    addTestResult('Rozet AkÄ±ÅŸÄ±', 'Rozet Hesaplama', 'PASS', `âœ… ${testPoints} puan iÃ§in rozetler: ${JSON.stringify(calculatedBadges)}`);
                } else {
                    addTestResult('Rozet AkÄ±ÅŸÄ±', 'Rozet Hesaplama', 'WARNING', 'âš ï¸ calculateBadges fonksiyonu bulunamadÄ±');
                }
                
                currentTest++; updateProgress();
                if (typeof window.saveBadge === 'function') {
                    addTestResult('Rozet AkÄ±ÅŸÄ±', 'Rozet Kaydetme', 'PASS', 'âœ… saveBadge fonksiyonu mevcut');
                } else {
                    addTestResult('Rozet AkÄ±ÅŸÄ±', 'Rozet Kaydetme', 'FAIL', 'âŒ saveBadge fonksiyonu bulunamadÄ±');
                }
                
                currentTest++; updateProgress();
                if (typeof window.showBadgesModal === 'function' || typeof window.updateBadgeVisualization === 'function') {
                    addTestResult('Rozet AkÄ±ÅŸÄ±', 'Rozet GÃ¶rselleÅŸtirme', 'PASS', 'âœ… Rozet gÃ¶rselleÅŸtirme fonksiyonlarÄ± mevcut');
                } else {
                    addTestResult('Rozet AkÄ±ÅŸÄ±', 'Rozet GÃ¶rselleÅŸtirme', 'WARNING', 'âš ï¸ Rozet gÃ¶rselleÅŸtirme fonksiyonlarÄ± bulunamadÄ±');
                }
                
            } catch (error) {
                addTestResult('Rozet AkÄ±ÅŸÄ±', 'Genel Hata', 'FAIL', `âŒ Hata: ${error.message}`);
            }
        }
        
        async function testDailyTaskFlow() {
            console.log('ğŸ§ª GÃ¼nlÃ¼k GÃ¶rev AkÄ±ÅŸÄ± Testi BaÅŸlatÄ±lÄ±yor...');
            currentTest = 0;
            totalTests = 4;
            
            try {
                currentTest++; updateProgress();
                if (typeof window.loadDailyTasks === 'function') {
                    const tasks = await window.loadDailyTasks();
                    addTestResult('GÃ¶rev AkÄ±ÅŸÄ±', 'GÃ¶rev YÃ¼kleme', 'PASS', `âœ… GÃ¼nlÃ¼k gÃ¶revler yÃ¼klendi: ${tasks ? Object.keys(tasks).length : 0} gÃ¶rev`);
                } else {
                    addTestResult('GÃ¶rev AkÄ±ÅŸÄ±', 'GÃ¶rev YÃ¼kleme', 'FAIL', 'âŒ loadDailyTasks fonksiyonu bulunamadÄ±');
                }
                
                currentTest++; updateProgress();
                if (typeof window.saveDailyTasks === 'function') {
                    addTestResult('GÃ¶rev AkÄ±ÅŸÄ±', 'GÃ¶rev Kaydetme', 'PASS', 'âœ… saveDailyTasks fonksiyonu mevcut');
                } else {
                    addTestResult('GÃ¶rev AkÄ±ÅŸÄ±', 'GÃ¶rev Kaydetme', 'FAIL', 'âŒ saveDailyTasks fonksiyonu bulunamadÄ±');
                }
                
                currentTest++; updateProgress();
                const tasks = await window.loadDailyTasks();
                if (tasks && tasks.todayStats) {
                    addTestResult('GÃ¶rev AkÄ±ÅŸÄ±', 'GÃ¶rev Ä°lerlemesi', 'PASS', `âœ… GÃ¶rev ilerlemesi mevcut: ${JSON.stringify(tasks.todayStats)}`);
                } else {
                    addTestResult('GÃ¶rev AkÄ±ÅŸÄ±', 'GÃ¶rev Ä°lerlemesi', 'WARNING', 'âš ï¸ GÃ¶rev ilerlemesi bilgisi yok');
                }
                
                currentTest++; updateProgress();
                if (tasks && tasks.completedTasks) {
                    addTestResult('GÃ¶rev AkÄ±ÅŸÄ±', 'Tamamlanan GÃ¶revler', 'PASS', `âœ… Tamamlanan gÃ¶revler: ${tasks.completedTasks.length}`);
                } else {
                    addTestResult('GÃ¶rev AkÄ±ÅŸÄ±', 'Tamamlanan GÃ¶revler', 'PASS', 'âœ… Tamamlanan gÃ¶revler sistemi mevcut');
                }
                
            } catch (error) {
                addTestResult('GÃ¶rev AkÄ±ÅŸÄ±', 'Genel Hata', 'FAIL', `âŒ Hata: ${error.message}`);
            }
        }
        
        async function testFirebaseSync() {
            console.log('ğŸ§ª Firebase Senkronizasyon Testi BaÅŸlatÄ±lÄ±yor...');
            currentTest = 0;
            totalTests = 5;
            
            try {
                currentTest++; updateProgress();
                const backendType = window.getBackendType();
                addTestResult('Firebase Senkronizasyon', 'Backend Tipi', 'PASS', `âœ… Backend tipi: ${backendType}`);
                
                currentTest++; updateProgress();
                const auth = window.getFirebaseAuth();
                if (auth) {
                    addTestResult('Firebase Senkronizasyon', 'Firebase BaÄŸlantÄ±sÄ±', 'PASS', 'âœ… Firebase Auth baÄŸlantÄ±sÄ± mevcut');
                } else {
                    addTestResult('Firebase Senkronizasyon', 'Firebase BaÄŸlantÄ±sÄ±', 'WARNING', 'âš ï¸ Firebase Auth baÄŸlantÄ±sÄ± yok');
                }
                
                currentTest++; updateProgress();
                if (typeof window.firestoreGet === 'function') {
                    const user = await window.getCurrentUser();
                    if (user) {
                        try {
                            const userStats = await window.firestoreGet('user_stats', user.id);
                            addTestResult('Firebase Senkronizasyon', 'Veri Okuma', 'PASS', `âœ… Firestore'dan veri okundu: ${userStats ? 'Var' : 'Yok'}`);
                        } catch (error) {
                            addTestResult('Firebase Senkronizasyon', 'Veri Okuma', 'WARNING', `âš ï¸ Firestore okuma hatasÄ±: ${error.message}`);
                        }
                    } else {
                        addTestResult('Firebase Senkronizasyon', 'Veri Okuma', 'WARNING', 'âš ï¸ KullanÄ±cÄ± giriÅŸ yapmamÄ±ÅŸ');
                    }
                } else {
                    addTestResult('Firebase Senkronizasyon', 'Veri Okuma', 'FAIL', 'âŒ firestoreGet fonksiyonu bulunamadÄ±');
                }
                
                currentTest++; updateProgress();
                if (typeof window.firestoreSet === 'function') {
                    addTestResult('Firebase Senkronizasyon', 'Veri Yazma', 'PASS', 'âœ… firestoreSet fonksiyonu mevcut');
                } else {
                    addTestResult('Firebase Senkronizasyon', 'Veri Yazma', 'FAIL', 'âŒ firestoreSet fonksiyonu bulunamadÄ±');
                }
                
                currentTest++; updateProgress();
                const localStoragePoints = parseInt(localStorage.getItem('hasene_totalPoints') || localStorage.getItem('hasene_total_points') || '0');
                const stats = await window.loadUserStats();
                const firebasePoints = stats?.total_points || 0;
                if (Math.abs(localStoragePoints - firebasePoints) <= 1) {
                    addTestResult('Firebase Senkronizasyon', 'Senkronizasyon', 'PASS', `âœ… localStorage ve Firebase senkronize: localStorage=${localStoragePoints}, Firebase=${firebasePoints}`);
                } else {
                    addTestResult('Firebase Senkronizasyon', 'Senkronizasyon', 'WARNING', `âš ï¸ localStorage ve Firebase farklÄ±: localStorage=${localStoragePoints}, Firebase=${firebasePoints}`);
                }
                
            } catch (error) {
                addTestResult('Firebase Senkronizasyon', 'Genel Hata', 'FAIL', `âŒ Hata: ${error.message}`);
            }
        }
        
        async function testEdgeCases() {
            console.log('ğŸ§ª Edge Cases Testi BaÅŸlatÄ±lÄ±yor...');
            currentTest = 0;
            totalTests = 5;
            
            try {
                currentTest++; updateProgress();
                const user = await window.getCurrentUser();
                if (user && user.id && user.username) {
                    addTestResult('Edge Cases', 'Null KontrolÃ¼', 'PASS', 'âœ… getCurrentUser null dÃ¶ndÃ¼rmÃ¼yor');
                } else {
                    addTestResult('Edge Cases', 'Null KontrolÃ¼', 'WARNING', 'âš ï¸ getCurrentUser null dÃ¶ndÃ¼ (normal olabilir)');
                }
                
                currentTest++; updateProgress();
                const email = localStorage.getItem('hasene_user_email');
                if (email && email !== '' && email !== 'null') {
                    addTestResult('Edge Cases', 'BoÅŸ String KontrolÃ¼', 'PASS', `âœ… Email boÅŸ string deÄŸil: ${email}`);
                } else {
                    addTestResult('Edge Cases', 'BoÅŸ String KontrolÃ¼', 'WARNING', 'âš ï¸ Email boÅŸ veya "null" string');
                }
                
                currentTest++; updateProgress();
                const stats = await window.loadUserStats();
                if (stats && stats.total_points >= 0) {
                    addTestResult('Edge Cases', 'Negatif Puan KontrolÃ¼', 'PASS', `âœ… Puan negatif deÄŸil: ${stats.total_points}`);
                } else {
                    addTestResult('Edge Cases', 'Negatif Puan KontrolÃ¼', 'FAIL', `âŒ Puan negatif: ${stats?.total_points}`);
                }
                
                currentTest++; updateProgress();
                const dailyXP = parseInt(localStorage.getItem('dailyXP') || '0');
                if (dailyXP >= 0 && dailyXP < 1000000) {
                    addTestResult('Edge Cases', 'BÃ¼yÃ¼k SayÄ± KontrolÃ¼', 'PASS', `âœ… GÃ¼nlÃ¼k XP makul aralÄ±kta: ${dailyXP}`);
                } else {
                    addTestResult('Edge Cases', 'BÃ¼yÃ¼k SayÄ± KontrolÃ¼', 'WARNING', `âš ï¸ GÃ¼nlÃ¼k XP beklenmedik: ${dailyXP}`);
                }
                
                currentTest++; updateProgress();
                const today = new Date().toISOString().split('T')[0];
                addTestResult('Edge Cases', 'Tarih FormatÄ±', 'PASS', `âœ… BugÃ¼nÃ¼n tarihi: ${today}`);
                
            } catch (error) {
                addTestResult('Edge Cases', 'Genel Hata', 'FAIL', `âŒ Hata: ${error.message}`);
            }
        }
        
        async function testPerformance() {
            console.log('ğŸ§ª Performans Testi BaÅŸlatÄ±lÄ±yor...');
            currentTest = 0;
            totalTests = 4;
            
            try {
                currentTest++; updateProgress();
                const start1 = performance.now();
                for (let i = 0; i < 10; i++) {
                    await window.getCurrentUser();
                }
                const end1 = performance.now();
                const avgTime = (end1 - start1) / 10;
                if (avgTime < 100) {
                    addTestResult('Performans', 'getCurrentUser HÄ±zÄ±', 'PASS', `âœ… Ortalama sÃ¼re: ${avgTime.toFixed(2)}ms (10 Ã§aÄŸrÄ±)`);
                } else {
                    addTestResult('Performans', 'getCurrentUser HÄ±zÄ±', 'WARNING', `âš ï¸ Ortalama sÃ¼re yavaÅŸ: ${avgTime.toFixed(2)}ms`);
                }
                
                currentTest++; updateProgress();
                const start2 = performance.now();
                await window.loadUserStats();
                const end2 = performance.now();
                const loadTime = end2 - start2;
                if (loadTime < 500) {
                    addTestResult('Performans', 'loadUserStats HÄ±zÄ±', 'PASS', `âœ… YÃ¼kleme sÃ¼resi: ${loadTime.toFixed(2)}ms`);
                } else {
                    addTestResult('Performans', 'loadUserStats HÄ±zÄ±', 'WARNING', `âš ï¸ YÃ¼kleme sÃ¼resi yavaÅŸ: ${loadTime.toFixed(2)}ms`);
                }
                
                currentTest++; updateProgress();
                const start3 = performance.now();
                for (let i = 0; i < 100; i++) {
                    localStorage.getItem('hasene_user_id');
                }
                const end3 = performance.now();
                const localStorageTime = (end3 - start3) / 100;
                addTestResult('Performans', 'localStorage HÄ±zÄ±', 'PASS', `âœ… Ortalama eriÅŸim sÃ¼resi: ${localStorageTime.toFixed(4)}ms (100 Ã§aÄŸrÄ±)`);
                
                currentTest++; updateProgress();
                const functionCount = Object.keys(window).filter(key => 
                    typeof window[key] === 'function' && 
                    (key.includes('Badge') || key.includes('Points') || key.includes('Stats') || key.includes('Task'))
                ).length;
                addTestResult('Performans', 'Fonksiyon SayÄ±sÄ±', 'PASS', `âœ… Ä°lgili fonksiyon sayÄ±sÄ±: ${functionCount}`);
                
            } catch (error) {
                addTestResult('Performans', 'Genel Hata', 'FAIL', `âŒ Hata: ${error.message}`);
            }
        }
        
        async function testDataIntegrity() {
            console.log('ğŸ§ª Veri BÃ¼tÃ¼nlÃ¼ÄŸÃ¼ Testi BaÅŸlatÄ±lÄ±yor...');
            currentTest = 0;
            totalTests = 5;
            
            try {
                currentTest++; updateProgress();
                const stats = await window.loadUserStats();
                const localStoragePoints = parseInt(localStorage.getItem('hasene_totalPoints') || localStorage.getItem('hasene_total_points') || '0');
                if (stats && Math.abs(stats.total_points - localStoragePoints) <= 1) {
                    addTestResult('Veri BÃ¼tÃ¼nlÃ¼ÄŸÃ¼', 'Puan TutarlÄ±lÄ±ÄŸÄ±', 'PASS', `âœ… Puanlar tutarlÄ±: Stats=${stats.total_points}, localStorage=${localStoragePoints}`);
                } else {
                    addTestResult('Veri BÃ¼tÃ¼nlÃ¼ÄŸÃ¼', 'Puan TutarlÄ±lÄ±ÄŸÄ±', 'WARNING', `âš ï¸ Puanlar farklÄ±: Stats=${stats?.total_points}, localStorage=${localStoragePoints}`);
                }
                
                currentTest++; updateProgress();
                const user = await window.getCurrentUser();
                const localStorageUserId = localStorage.getItem('hasene_user_id');
                if (user && user.id === localStorageUserId) {
                    addTestResult('Veri BÃ¼tÃ¼nlÃ¼ÄŸÃ¼', 'KullanÄ±cÄ± ID TutarlÄ±lÄ±ÄŸÄ±', 'PASS', `âœ… KullanÄ±cÄ± ID'leri tutarlÄ±: ${user.id}`);
                } else {
                    addTestResult('Veri BÃ¼tÃ¼nlÃ¼ÄŸÃ¼', 'KullanÄ±cÄ± ID TutarlÄ±lÄ±ÄŸÄ±', 'WARNING', `âš ï¸ KullanÄ±cÄ± ID'leri farklÄ±: user=${user?.id}, localStorage=${localStorageUserId}`);
                }
                
                currentTest++; updateProgress();
                const localStorageEmail = localStorage.getItem('hasene_user_email');
                if (user && user.email === localStorageEmail) {
                    addTestResult('Veri BÃ¼tÃ¼nlÃ¼ÄŸÃ¼', 'Email TutarlÄ±lÄ±ÄŸÄ±', 'PASS', `âœ… Email'ler tutarlÄ±: ${user.email}`);
                } else if (user && user.email && localStorageEmail && user.email !== 'null' && localStorageEmail !== 'null') {
                    addTestResult('Veri BÃ¼tÃ¼nlÃ¼ÄŸÃ¼', 'Email TutarlÄ±lÄ±ÄŸÄ±', 'WARNING', `âš ï¸ Email'ler farklÄ±: user=${user.email}, localStorage=${localStorageEmail}`);
                } else {
                    addTestResult('Veri BÃ¼tÃ¼nlÃ¼ÄŸÃ¼', 'Email TutarlÄ±lÄ±ÄŸÄ±', 'PASS', 'âœ… Email tutarlÄ±lÄ±ÄŸÄ± kontrol edildi');
                }
                
                currentTest++; updateProgress();
                const points = stats?.total_points;
                if (typeof points === 'number' && !isNaN(points)) {
                    addTestResult('Veri BÃ¼tÃ¼nlÃ¼ÄŸÃ¼', 'Veri Tipi KontrolÃ¼', 'PASS', `âœ… Puan tipi doÄŸru: number (${points})`);
                } else {
                    addTestResult('Veri BÃ¼tÃ¼nlÃ¼ÄŸÃ¼', 'Veri Tipi KontrolÃ¼', 'FAIL', `âŒ Puan tipi yanlÄ±ÅŸ: ${typeof points}`);
                }
                
                currentTest++; updateProgress();
                const badges = await window.loadBadges();
                if (badges && typeof badges === 'object') {
                    addTestResult('Veri BÃ¼tÃ¼nlÃ¼ÄŸÃ¼', 'Veri KaybÄ± KontrolÃ¼', 'PASS', `âœ… Rozet verileri mevcut: ${Object.keys(badges).length} rozet`);
                } else {
                    addTestResult('Veri BÃ¼tÃ¼nlÃ¼ÄŸÃ¼', 'Veri KaybÄ± KontrolÃ¼', 'WARNING', 'âš ï¸ Rozet verileri eksik veya bozuk');
                }
                
            } catch (error) {
                addTestResult('Veri BÃ¼tÃ¼nlÃ¼ÄŸÃ¼', 'Genel Hata', 'FAIL', `âŒ Hata: ${error.message}`);
            }
        }
        
        // ============================================
        // TEST Ã‡ALIÅTIRMA FONKSÄ°YONLARI
        // ============================================
        
        async function runBasicTests() {
            console.log('ğŸš€ Temel Testler BaÅŸlatÄ±lÄ±yor...');
            testResults = [];
            totalTests = 0;
            currentTest = 0;
            testStartTime = new Date();
            
            await testUserSystem();
            await testGameModes();
            await testPointsSystem();
            await testBadges();
            await testDailyTasks();
            await testFirebase();
            await testGameplay();
            
            totalTests = 0;
            currentTest = 0;
            updateProgress();
            
            console.log('âœ… Temel testler tamamlandÄ±!');
        }
        
        async function runAdvancedTests() {
            console.log('ğŸš€ GeliÅŸmiÅŸ Testler BaÅŸlatÄ±lÄ±yor...');
            testResults = [];
            totalTests = 0;
            currentTest = 0;
            testStartTime = new Date();
            
            await testPointsFlow();
            await testBadgeFlow();
            await testDailyTaskFlow();
            await testFirebaseSync();
            await testEdgeCases();
            await testPerformance();
            await testDataIntegrity();
            
            totalTests = 0;
            currentTest = 0;
            updateProgress();
            
            console.log('âœ… GeliÅŸmiÅŸ testler tamamlandÄ±!');
        }
        
        async function runAllTests() {
            console.log('ğŸš€ TÃœM TESTLER BAÅLATILIYOR...');
            testResults = [];
            totalTests = 0;
            currentTest = 0;
            testStartTime = new Date();
            
            // Temel testler
            await runBasicTests();
            
            // GeliÅŸmiÅŸ testler
            await runAdvancedTests();
            
            totalTests = 0;
            currentTest = 0;
            updateProgress();
            
            console.log('âœ… TÃœM TESTLER TAMAMLANDI!');
        }
        
        function exportResults() {
            if (testResults.length === 0) {
                alert('Ã–nce testleri Ã§alÄ±ÅŸtÄ±rÄ±n!');
                return;
            }
            
            const stats = {
                total: testResults.length,
                passed: testResults.filter(r => r.status === 'PASS').length,
                failed: testResults.filter(r => r.status === 'FAIL').length,
                warnings: testResults.filter(r => r.status === 'WARNING').length
            };
            
            const exportData = {
                testSuite: 'KapsamlÄ± Oyun Test Suite',
                timestamp: new Date().toISOString(),
                duration: testStartTime ? ((new Date() - testStartTime) / 1000).toFixed(2) + 's' : 'N/A',
                summary: {
                    totalTests: stats.total,
                    passed: stats.passed,
                    failed: stats.failed,
                    warnings: stats.warnings,
                    successRate: stats.total > 0 ? Math.round((stats.passed / stats.total) * 100) : 0
                },
                results: testResults,
                categories: {}
            };
            
            // Kategorilere gÃ¶re grupla
            testResults.forEach(result => {
                if (!exportData.categories[result.category]) {
                    exportData.categories[result.category] = [];
                }
                exportData.categories[result.category].push(result);
            });
            
            const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `test-results-${new Date().toISOString().split('T')[0]}-${Date.now()}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }
        
        function clearResults() {
            testResults = [];
            totalTests = 0;
            currentTest = 0;
            testStartTime = null;
            updateProgress();
            displayResults();
        }
        
        // Sayfa yÃ¼klendiÄŸinde
        window.addEventListener('load', () => {
            console.log('âœ… KapsamlÄ± test sayfasÄ± yÃ¼klendi');
            console.log('ğŸ’¡ "TÃœM TESTLERÄ° Ã‡ALIÅTIR" butonuna tÄ±klayarak tÃ¼m testleri baÅŸlatabilirsiniz');
        });
    </script>
</body>
</html>
